using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MarsTest.Utilities;
using OpenQA.Selenium.Support.UI;

namespace MarsTest.Pages
{
    public class LanguageTab
    {
        public void CreateLanguage(IWebDriver driver, string Language, string Level)
        {
            //Click Language Tab
            //WaitHelpers.WaitToBeClickable(driver, 5, "LinkText", "Languages");
            IWebElement LanguageTab = driver.FindElement(By.LinkText("Languages"));
            LanguageTab.Click();
            // Add NewLanguage
            WaitHelpers.WaitToBeClickable(driver, 5, "XPath", "//div/section[2]/div/div/div/div[3]/form/div[2]/div/div[2]/div/table/thead/tr/th[3]/div");
            IWebElement AddNewLan = driver.FindElement(By.XPath("//div/section[2]/div/div/div/div[3]/form/div[2]/div/div[2]/div/table/thead/tr/th[3]/div"));
            AddNewLan.Click();
            //Add Text to NewLanguage
            IWebElement TextLanguage = driver.FindElement(By.Name("name"));
            TextLanguage.SendKeys(Language);
            WaitHelpers.WaitToBeClickable(driver, 5, "Name", "level");
            //Select LanguageLevel
            SelectElement LanguageLevel = new SelectElement(driver.FindElement(By.Name("level")));
            LanguageLevel.SelectByValue(Level);
            //Click Add Language Button
            IWebElement AddLanguage = driver.FindElement(By.XPath("//div/section[2]/div/div/div/div[3]/form/div[2]/div/div[2]/div/div/div[3]/input[1]"));
            AddLanguage.Click();

        }
        
        public string createlanguages(IWebDriver driver)
        {
            Thread.Sleep(3000);
            //WaitHelpers.WaitToExist(driver, 3, "XPath", "//body/div[@id='account-profile-section']/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]");
            IWebElement newlanguage = driver.FindElement(By.XPath("//body/div[@id='account-profile-section']/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]"));
            return newlanguage.GetAttribute("outerText").ToString();
            
        }

        public void EditLanguage(IWebDriver driver, string Language, string Level)
        {
            IWebElement LanguageTab = driver.FindElement(By.LinkText("Languages"));
            LanguageTab.Click();
            //Click Edit language button
            Thread.Sleep(3000);
            IWebElement Languageedit = driver.FindElement(By.XPath("//body[1]/div[1]/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]/table[1]/tbody[1]/tr[1]/td[3]/span[1]"));
            Languageedit.Click();
            //Edit Language textbox
            IWebElement Langugetextbox = driver.FindElement(By.Name("name"));
            Langugetextbox.Clear();
            Langugetextbox.SendKeys(Language);
            //Edit Language Level
            SelectElement Languageleveledit = new SelectElement(driver.FindElement(By.Name("level")));
            Languageleveledit.SelectByValue(Level);
            //Click Update button
            Thread.Sleep(3000);
            IWebElement updatebutton = driver.FindElement(By.XPath("//tbody/tr[1]/td[1]/div[1]/span[1]/input[1]"));
            updatebutton.Click();

        }
        public string GetLanguage(IWebDriver driver)
        {
            Thread.Sleep(3000);
            //WaitHelpers.WaitToExist(driver, 5, "XPath", "//body/div[@id='account-profile-section']/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]");
            IWebElement firstlanguage = driver.FindElement(By.XPath("//body/div[@id='account-profile-section']/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]"));
            return firstlanguage.GetAttribute("outerText").ToString();
        }

        public void DeleteLanguage(IWebDriver driver)
        {
            IWebElement LanguageTab = driver.FindElement(By.LinkText("Languages"));
            LanguageTab.Click();
            IWebElement deletelastrow = driver.FindElement(By.XPath("//body[1]/div[1]/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]/table[1]/tbody[4]/tr[1]/td[3]/span[2]"));
            deletelastrow.Click();
            IWebElement deletethirdrow = driver.FindElement(By.XPath("//body[1]/div[1]/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]/table[1]/tbody[3]/tr[1]/td[3]/span[2]"));
            deletethirdrow.Click();
            driver.Navigate().Refresh();
            WaitHelpers.WaitToBeClickable(driver, 5, "XPath", "//body[1]/div[1]/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]/table[1]/tbody[2]/tr[1]/td[3]/span[2]/i[1]");
            IWebElement deletesecondrow = driver.FindElement(By.XPath("//body[1]/div[1]/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]/table[1]/tbody[2]/tr[1]/td[3]/span[2]"));
            deletesecondrow.Click();
            IWebElement deletefirstrow = driver.FindElement(By.XPath("//body[1]/div[1]/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]/table[1]/tbody[1]/tr[1]/td[3]/span[2]"));
            deletefirstrow.Click();

        }

        public string deletelanguages(IWebDriver driver)
        {
            Thread.Sleep(3000);
            //WaitHelpers.WaitToExist(driver, 5, "XPath", "//body/div[@id='account-profile-section']/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]");
            IWebElement lastlanguage = driver.FindElement(By.XPath("//body/div[@id='account-profile-section']/div[1]/section[2]/div[1]/div[1]/div[1]/div[3]/form[1]/div[2]/div[1]/div[2]/div[1]"));
            return lastlanguage.GetAttribute("outerText").ToString();

        }


    }
}























































































































































































































































































































































































































































































































































































































































































































































































































































































































